import{_ as V,c as f,o as i,w as a,a as t,Q as u,e as m,b as e,an as h,f as p,d as c,t as d,a2 as _,a3 as Q,a4 as w,W as k,Z as g}from"./index-H1xfLONU.js";import{Q as b}from"./QSelect-B5Q5KX5I.js";import{Q as C,d as U,a as q,b as v,C as y}from"./ClosePopup-BWUG6Kch.js";import{Q as N}from"./format-BLZ5nlkB.js";import{Q as F}from"./QMarkupTable-r3-gjMWZ.js";import{Q as Y}from"./QPage-BwE-RHpL.js";import{h as x}from"./moment-C5S46NFB.js";import"./selection-B1P-o9T7.js";const z={name:"PrestamosPage",data(){return{prestamos:[],usuarios:[],estados:["Todos","Pendiente","Pagado","Cancelado","Vencido"],filters:{fecha_inicio:x().startOf("week").format("YYYY-MM-DD"),fecha_fin:x().endOf("week").format("YYYY-MM-DD"),user_id:null,estado:"Todos"},resumen:{prestado:0,interes:0,saldo:0},loading:!1}},mounted(){this.getUsuarios(),this.getPrestamos()},methods:{getUsuarios(){this.$axios.get("users").then(o=>{this.usuarios=[{id:null,name:"Todos"},...o.data]})},getPrestamos(){this.loading=!0,this.$axios.get("prestamos",{params:this.filters}).then(o=>{this.prestamos=o.data,this.calcularResumen()}).catch(o=>this.$alert.error(o.response?.data?.message||"Error al obtener préstamos")).finally(()=>{this.loading=!1})},calcularResumen(){this.resumen.prestado=this.prestamos.reduce((o,s)=>o+Number(s.valor_prestado),0),this.resumen.interes=this.prestamos.reduce((o,s)=>o+Number(s.interes),0),this.resumen.saldo=this.prestamos.reduce((o,s)=>o+Number(s.saldo),0)},colorEstado(o){return o==="Pendiente"?"orange":o==="Pagado"?"green":o==="Cancelado"?"red":o==="Vencido"?"deep-orange":"grey"}}},D={class:"row q-col-gutter-sm"},E={class:"col-12 col-md-3"},I={class:"col-12 col-md-3"},S={class:"col-12 col-md-3"},B={class:"col-12 col-md-3"},M={class:"col-12 col-md-2 q-mt-sm"},O={class:"col-12 col-md-2 q-mt-sm"},T={class:"col-12 col-md-8 q-mt-sm"},A={class:"row q-col-gutter-sm"},L={class:"col-12 col-md-4"},R={class:"text-h6"},W={class:"col-12 col-md-4"},Z={class:"text-h6"},j={class:"col-12 col-md-4"},G={class:"text-h6"},H={class:"col-12 q-mt-sm"};function J(o,s,K,X,r,n){return i(),f(Y,{class:"q-pa-xs"},{default:a(()=>[t(u,{flat:"",bordered:""},{default:a(()=>[t(m,null,{default:a(()=>[e("div",D,[e("div",E,[t(h,{type:"date",label:"Fecha Inicio",dense:"",outlined:"",modelValue:r.filters.fecha_inicio,"onUpdate:modelValue":[s[0]||(s[0]=l=>r.filters.fecha_inicio=l),n.getPrestamos]},null,8,["modelValue","onUpdate:modelValue"])]),e("div",I,[t(h,{type:"date",label:"Fecha Fin",dense:"",outlined:"",modelValue:r.filters.fecha_fin,"onUpdate:modelValue":[s[1]||(s[1]=l=>r.filters.fecha_fin=l),n.getPrestamos]},null,8,["modelValue","onUpdate:modelValue"])]),e("div",S,[t(b,{modelValue:r.filters.user_id,"onUpdate:modelValue":[s[2]||(s[2]=l=>r.filters.user_id=l),n.getPrestamos],options:r.usuarios,"option-label":"name","option-value":"id","emit-value":"","map-options":"",dense:"",outlined:"",label:"Usuario"},null,8,["modelValue","options","onUpdate:modelValue"])]),e("div",B,[t(b,{modelValue:r.filters.estado,"onUpdate:modelValue":[s[3]||(s[3]=l=>r.filters.estado=l),n.getPrestamos],options:r.estados,dense:"",outlined:"",label:"Estado"},null,8,["modelValue","options","onUpdate:modelValue"])]),e("div",M,[t(p,{color:"primary",label:"Actualizar",icon:"refresh",onClick:n.getPrestamos,loading:r.loading,"no-caps":"",size:"10px"},null,8,["onClick","loading"])]),e("div",O,[t(p,{color:"green",label:"Nuevo Préstamo",icon:"add",onClick:s[4]||(s[4]=l=>o.$router.push("/prestamos/crear")),"no-caps":"",size:"10px"})]),e("div",T,[e("div",A,[e("div",L,[t(u,{bordered:"",class:"bg-blue-1"},{default:a(()=>[t(m,{class:"row items-center"},{default:a(()=>[t(c,{name:"savings",color:"blue",size:"lg",class:"q-mr-sm"}),e("div",null,[s[5]||(s[5]=e("div",{class:"text-subtitle1 text-weight-bold text-blue"},"Prestado",-1)),e("div",R,d(r.resumen.prestado.toFixed(2)),1)])]),_:1})]),_:1})]),e("div",W,[t(u,{bordered:"",class:"bg-orange-1"},{default:a(()=>[t(m,{class:"row items-center"},{default:a(()=>[t(c,{name:"stacked_bar_chart",color:"orange",size:"lg",class:"q-mr-sm"}),e("div",null,[s[6]||(s[6]=e("div",{class:"text-subtitle1 text-weight-bold text-orange"},"Interés",-1)),e("div",Z,d(r.resumen.interes.toFixed(2)),1)])]),_:1})]),_:1})]),e("div",j,[t(u,{bordered:"",class:"bg-red-1"},{default:a(()=>[t(m,{class:"row items-center"},{default:a(()=>[t(c,{name:"account_balance_wallet",color:"red",size:"lg",class:"q-mr-sm"}),e("div",null,[s[7]||(s[7]=e("div",{class:"text-subtitle1 text-weight-bold text-red"},"Saldo",-1)),e("div",G,d(r.resumen.saldo.toFixed(2)),1)])]),_:1})]),_:1})])])]),e("div",H,[t(F,{dense:"",flat:"",bordered:""},{default:a(()=>[s[9]||(s[9]=e("thead",null,[e("tr",{class:"bg-primary text-white"},[e("th",null,"#"),e("th",null,"Opciones"),e("th",null,"Nro"),e("th",null,"Fecha"),e("th",null,"Cliente"),e("th",null,"Usuario"),e("th",null,"Estado"),e("th",null,"Peso"),e("th",null,"Precio Oro"),e("th",null,"Prestado"),e("th",null,"Interés"),e("th",null,"Saldo")])],-1)),e("tbody",null,[(i(!0),_(Q,null,w(r.prestamos,(l,P)=>(i(),_("tr",{key:l.id},[e("td",null,d(P+1),1),e("td",null,[t(C,{dense:"",color:"primary","no-caps":"",label:"Opciones",size:"10px"},{default:a(()=>[t(U,null,{default:a(()=>[k((i(),f(q,{clickable:"",onClick:$=>o.$router.push("/prestamos/editar/"+l.id)},{default:a(()=>[t(v,{avatar:""},{default:a(()=>[t(c,{name:"edit"})]),_:1}),t(v,null,{default:a(()=>s[8]||(s[8]=[g("Editar")])),_:1})]),_:2},1032,["onClick"])),[[y]])]),_:2},1024)]),_:2},1024)]),e("td",null,d(l.numero),1),e("td",null,d(String(l.fecha_creacion).substring(0,10)),1),e("td",null,d(l.cliente?.name||"N/A"),1),e("td",null,d(l.user?.name),1),e("td",null,[t(N,{color:n.colorEstado(l.estado),"text-color":"white",dense:""},{default:a(()=>[g(d(l.estado),1)]),_:2},1032,["color"])]),e("td",null,d(l.peso),1),e("td",null,d(l.precio_oro),1),e("td",null,d(l.valor_prestado),1),e("td",null,d(l.interes),1),e("td",null,d(l.saldo),1)]))),128))])]),_:1})])])]),_:1})]),_:1})]),_:1})}const ne=V(z,[["render",J]]);export{ne as default};
