import{j as A,at as Q,L as T,O as j,g as N,au as I,k as b,l as m,ap as B,aq as C,_ as L,c as V,o as u,w as o,a as s,Q as c,e as d,b as e,an as x,av as E,f as y,t as i,am as O,a2 as g,a1 as v,a3 as p,a4 as S}from"./index-H1xfLONU.js";import{Q as w}from"./QMarkupTable-r3-gjMWZ.js";import{Q as M}from"./QPage-BwE-RHpL.js";import{h as P}from"./moment-C5S46NFB.js";const z=A({name:"QInnerLoading",props:{...T,...Q,showing:Boolean,color:String,size:{type:[String,Number],default:"42px"},label:String,labelClass:String,labelStyle:[String,Array,Object]},setup(l,{slots:t}){const h=N(),f=j(l,h.proxy.$q),{transitionProps:a,transitionStyle:n}=I(l),r=b(()=>"q-inner-loading q--avoid-card-border absolute-full column flex-center"+(f.value===!0?" q-inner-loading--dark":"")),k=b(()=>"q-inner-loading__label"+(l.labelClass!==void 0?` ${l.labelClass}`:""));function D(){const _=[m(C,{size:l.size,color:l.color})];return l.label!==void 0&&_.push(m("div",{class:k.value,style:l.labelStyle},[l.label])),_}function q(){return l.showing===!0?m("div",{class:r.value,style:n.value},t.default!==void 0?t.default():D()):null}return()=>m(B,a.value,q)}}),U={name:"LibroDiario",data(){return{fecha:P().format("YYYY-MM-DD"),openingAmount:0,ingresos:{ordenes:{total:0,items:[]},pagos_ordenes:{total:0,items:[]}},totalIngresos:0,loading:!1,loadingSave:!1}},mounted(){this.fetchDiario()},methods:{currency(l){return`${Number(l||0).toFixed(2)} Bs.`},async fetchDiario(){this.loading=!0;try{const{data:l}=await this.$axios.get("daily-cash",{params:{date:this.fecha}});this.openingAmount=Number(l.daily_cash?.opening_amount||0),this.ingresos={ordenes:l.ingresos?.ordenes||{total:0,items:[]},pagos_ordenes:l.ingresos?.pagos_ordenes||{total:0,items:[]}},this.totalIngresos=Number(l.total_ingresos||0)}catch(l){this.$alert?.error?.(l.response?.data?.message||"Error al cargar el libro diario")}finally{this.loading=!1}},async guardarCaja(){this.loadingSave=!0;try{await this.$axios.post("daily-cash",{date:this.fecha,opening_amount:Number(this.openingAmount||0)}),this.$alert?.success?.("Caja inicial guardada"),this.fetchDiario()}catch(l){this.$alert?.error?.(l.response?.data?.message||"Error al guardar caja")}finally{this.loadingSave=!1}}}},G={class:"col-12 col-md-3"},R={class:"col-12 col-md-3"},Y={class:"col-12 col-md-3 flex items-center"},F={class:"col-12 col-md-3"},K={class:"text-h6"},H={class:"col-12 col-md-4 text-right text-h6"},J={class:"col-12 col-md-4 text-right text-h6"},W={class:"text-left"},X={class:"text-left"},Z={class:"text-left"},$={class:"text-right"},ee={key:0},te={class:"col-12 col-md-4 text-right text-h6"},se={class:"text-left"},le={class:"text-left"},oe={class:"text-left"},ae={class:"text-right"},re={key:0},ne={class:"row q-col-gutter-sm"},ie={class:"col-12 col-md-4"},de={class:"text-h6"},ce={class:"col-12 col-md-4"},ue={class:"text-h6"},ge={class:"col-12 col-md-4"},me={class:"text-h6"};function he(l,t,h,f,a,n){return u(),V(M,{class:"q-pa-sm bg-grey-2"},{default:o(()=>[s(c,{flat:"",bordered:""},{default:o(()=>[s(d,{class:"row items-center q-col-gutter-sm"},{default:o(()=>[e("div",G,[s(x,{type:"date",modelValue:a.fecha,"onUpdate:modelValue":[t[0]||(t[0]=r=>a.fecha=r),n.fetchDiario],label:"Fecha",dense:"",outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),e("div",R,[s(x,{modelValue:a.openingAmount,"onUpdate:modelValue":t[1]||(t[1]=r=>a.openingAmount=r),modelModifiers:{number:!0},type:"number",min:"0",step:"0.01",dense:"",outlined:"",label:"Caja inicial (Bs.)",onKeyup:E(n.guardarCaja,["enter"])},null,8,["modelValue","onKeyup"])]),e("div",Y,[s(y,{color:"primary",icon:"save",label:"Guardar caja","no-caps":"",loading:a.loadingSave,onClick:n.guardarCaja},null,8,["loading","onClick"]),s(y,{color:"grey",flat:"",icon:"refresh",label:"Actualizar",class:"q-ml-sm","no-caps":"",loading:a.loading,onClick:n.fetchDiario},null,8,["loading","onClick"])]),e("div",F,[s(c,{bordered:"",class:"bg-blue-1"},{default:o(()=>[s(d,{class:"q-pa-sm"},{default:o(()=>[t[2]||(t[2]=e("div",{class:"text-weight-bold text-blue"},"TOTAL INGRESOS",-1)),e("div",K,i(n.currency(a.totalIngresos)),1)]),_:1})]),_:1})])]),_:1}),s(O),s(d,null,{default:o(()=>[s(c,{bordered:"",class:"q-mb-sm"},{default:o(()=>[s(d,{class:"row items-center"},{default:o(()=>[t[3]||(t[3]=e("div",{class:"col-12 col-md-8 text-weight-bold"},"Caja inicial del día",-1)),e("div",H,i(n.currency(a.openingAmount)),1)]),_:1})]),_:1}),s(c,{bordered:"",class:"q-mb-md"},{default:o(()=>[s(d,{class:"row items-center"},{default:o(()=>[t[4]||(t[4]=e("div",{class:"col-12 col-md-8 text-weight-bold"},"Órdenes de Trabajo",-1)),e("div",J,i(n.currency(a.ingresos.ordenes.total)),1)]),_:1}),s(w,{flat:"",bordered:"",dense:""},{default:o(()=>[t[6]||(t[6]=e("thead",null,[e("tr",{class:"bg-green-6 text-white"},[e("th",{class:"text-left"},"Hora"),e("th",{class:"text-left"},"Descripción"),e("th",{class:"text-left"},"Usuario"),e("th",{class:"text-right"},"Monto (Bs.)")])],-1)),e("tbody",null,[(u(!0),g(p,null,S(a.ingresos.ordenes.items,r=>(u(),g("tr",{key:`o-${r.id}`},[e("td",W,i(r.hora),1),e("td",X,i(r.descripcion),1),e("td",Z,i(r.usuario),1),e("td",$,i(n.currency(r.monto)),1)]))),128)),a.ingresos.ordenes.items.length?v("",!0):(u(),g("tr",ee,t[5]||(t[5]=[e("td",{colspan:"4",class:"text-center text-grey"},"Sin ingresos por órdenes",-1)])))])]),_:1})]),_:1}),s(c,{bordered:"",class:"q-mb-md"},{default:o(()=>[s(d,{class:"row items-center"},{default:o(()=>[t[7]||(t[7]=e("div",{class:"col-12 col-md-8 text-weight-bold"},"Pagos de Órdenes",-1)),e("div",te,i(n.currency(a.ingresos.pagos_ordenes.total)),1)]),_:1}),s(w,{flat:"",bordered:"",dense:""},{default:o(()=>[t[9]||(t[9]=e("thead",null,[e("tr",{class:"bg-green-3 text-black"},[e("th",{class:"text-left"},"Hora"),e("th",{class:"text-left"},"Descripción"),e("th",{class:"text-left"},"Usuario"),e("th",{class:"text-right"},"Monto (Bs.)")])],-1)),e("tbody",null,[(u(!0),g(p,null,S(a.ingresos.pagos_ordenes.items,r=>(u(),g("tr",{key:`p-${r.id}`},[e("td",se,i(r.hora),1),e("td",le,i(r.descripcion),1),e("td",oe,i(r.usuario),1),e("td",ae,i(n.currency(r.monto)),1)]))),128)),a.ingresos.pagos_ordenes.items.length?v("",!0):(u(),g("tr",re,t[8]||(t[8]=[e("td",{colspan:"4",class:"text-center text-grey"},"Sin pagos registrados",-1)])))])]),_:1})]),_:1}),e("div",ne,[e("div",ie,[s(c,{bordered:"",class:"bg-green-1"},{default:o(()=>[s(d,null,{default:o(()=>[t[10]||(t[10]=e("div",{class:"text-weight-bold text-green-10"},"TOTAL ÓRDENES",-1)),e("div",de,i(n.currency(a.ingresos.ordenes.total)),1)]),_:1})]),_:1})]),e("div",ce,[s(c,{bordered:"",class:"bg-green-2"},{default:o(()=>[s(d,null,{default:o(()=>[t[11]||(t[11]=e("div",{class:"text-weight-bold text-green-10"},"TOTAL PAGOS ÓRDENES",-1)),e("div",ue,i(n.currency(a.ingresos.pagos_ordenes.total)),1)]),_:1})]),_:1})]),e("div",ge,[s(c,{bordered:"",class:"bg-blue-1"},{default:o(()=>[s(d,null,{default:o(()=>[t[12]||(t[12]=e("div",{class:"text-weight-bold text-blue-10"},"TOTAL INGRESOS (con caja)",-1)),e("div",me,i(n.currency(a.totalIngresos)),1)]),_:1})]),_:1})])])]),_:1}),s(z,{showing:a.loading},{default:o(()=>[s(C,{size:"32px"})]),_:1},8,["showing"])]),_:1})]),_:1})}const ye=L(U,[["render",he]]);export{ye as default};
