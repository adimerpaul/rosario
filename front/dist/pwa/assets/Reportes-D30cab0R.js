import{_ as b,Y as x,c as v,o as y,w as l,b as e,a as t,a6 as f,f as w,Q as r,e as i,a0 as p,t as g,a7 as _,a8 as N}from"./index-DElcYA51.js";import{Q as O}from"./QSelect-Dksol_qe.js";import{Q as S}from"./QInnerLoading-DYgxQ5cM.js";import{Q}from"./QPage-Czqrsfna.js";import{h}from"./moment-C5S46NFB.js";import{m as I}from"./vue3-apexcharts-CT-qKg7F.js";import"./QChip-DFLzAd7S.js";import"./format-7zDVHTIF.js";import"./selection-DFIQRjLs.js";const V={name:"ReportesPage",components:{apexchart:I},data(){return{loading:!1,usersOptions:[],filters:{date_from:h().startOf("month").format("YYYY-MM-DD"),date_to:h().format("YYYY-MM-DD"),users:[]},totals:{ingresos:0,egresos:0,neto:0},lineSeries:[{name:"Ingresos",data:[]},{name:"Egresos",data:[]},{name:"Neto",data:[]}],lineOptions:{chart:{toolbar:{show:!1}},stroke:{width:3,curve:"smooth"},dataLabels:{enabled:!1},xaxis:{categories:[]},tooltip:{y:{formatter:a=>`${Number(a||0).toFixed(2)} Bs.`}}},donutSeries:[],donutOptions:{labels:[],legend:{position:"bottom"},tooltip:{y:{formatter:a=>`${Number(a||0).toFixed(2)} Bs.`}}},barSeries:[{name:"Ingresos",data:[]}],barOptions:{chart:{toolbar:{show:!1}},plotOptions:{bar:{borderRadius:6,columnWidth:"55%"}},dataLabels:{enabled:!1},xaxis:{categories:[]},tooltip:{y:{formatter:a=>`${Number(a||0).toFixed(2)} Bs.`}}}}},mounted(){this.load()},methods:{money(a){return`${Number(a||0).toFixed(2)} Bs.`},async load(){this.loading=!0;try{const{data:a}=await this.$axios.get("dashboard/reportes",{params:{date_from:this.filters.date_from,date_to:this.filters.date_to,users:this.filters.users}});this.usersOptions=(a?.users||[]).map(s=>({label:s.name,value:s.id})),this.totals.ingresos=Number(a?.totals?.ingresos||0),this.totals.egresos=Number(a?.totals?.egresos||0),this.totals.neto=Number(a?.totals?.neto||0);const o=Array.isArray(a?.days)?a.days:[];this.lineOptions={...this.lineOptions,xaxis:{categories:o.map(s=>h(s.date).format("DD/MM"))}},this.lineSeries=[{name:"Ingresos",data:o.map(s=>Number(s.ingresos||0))},{name:"Egresos",data:o.map(s=>Number(s.egresos||0))},{name:"Neto",data:o.map(s=>Number(s.neto||0))}];const c=Array.isArray(a?.metodos_pago)?a.metodos_pago:[];this.donutOptions={...this.donutOptions,labels:c.map(s=>s.metodo)},this.donutSeries=c.map(s=>Number(s.total||0));const m=Array.isArray(a?.ingresos_por_usuario)?a.ingresos_por_usuario:[];this.barOptions={...this.barOptions,xaxis:{categories:m.map(s=>s.user_name)}},this.barSeries=[{name:"Ingresos",data:m.map(s=>Number(s.total||0))}]}catch(a){this.$q.notify({type:"negative",message:a.response?.data?.message||"Error al cargar reportes"})}finally{this.loading=!1}}}},q={class:"row items-center q-col-gutter-sm q-mb-md"},B={class:"col-12 col-md-3"},D={class:"col-12 col-md-3"},Y={class:"col-12 col-md-3"},k={class:"col-auto"},A={class:"row q-col-gutter-md q-mb-md"},M={class:"col-12 col-md-4"},C={class:"col-auto"},E={class:"col"},R={class:"text-h6"},F={class:"col-12 col-md-4"},U={class:"col-auto"},L={class:"col"},P={class:"text-h6"},z={class:"col-12 col-md-4"},H={class:"col-auto"},W={class:"col"},j={class:"text-h6"},G={class:"row q-col-gutter-md"},J={class:"col-12 col-lg-7"},K={class:"col-12 col-lg-5"},T={class:"col-12"};function X(a,o,c,m,s,d){const u=x("apexchart");return y(),v(Q,{class:"q-pa-md bg-grey-2"},{default:l(()=>[e("div",q,[o[3]||(o[3]=e("div",{class:"col"},[e("div",{class:"text-h5 text-weight-bold"},"Reportes"),e("div",{class:"text-caption text-grey-7"},"Ingresos/Egresos por fechas y usuarios.")],-1)),e("div",B,[t(f,{dense:"",outlined:"",type:"date",modelValue:s.filters.date_from,"onUpdate:modelValue":o[0]||(o[0]=n=>s.filters.date_from=n),label:"Desde"},null,8,["modelValue"])]),e("div",D,[t(f,{dense:"",outlined:"",type:"date",modelValue:s.filters.date_to,"onUpdate:modelValue":o[1]||(o[1]=n=>s.filters.date_to=n),label:"Hasta"},null,8,["modelValue"])]),e("div",Y,[t(O,{dense:"",outlined:"",modelValue:s.filters.users,"onUpdate:modelValue":o[2]||(o[2]=n=>s.filters.users=n),options:s.usersOptions,label:"Usuarios",multiple:"","emit-value":"","map-options":"","use-chips":"",clearable:""},null,8,["modelValue","options"])]),e("div",k,[t(w,{color:"primary",icon:"search",label:"Buscar","no-caps":"",loading:s.loading,onClick:d.load},null,8,["loading","onClick"])])]),e("div",A,[e("div",M,[t(r,{flat:"",bordered:"",class:"shadow-1"},{default:l(()=>[t(i,{class:"row items-center q-col-gutter-sm"},{default:l(()=>[e("div",C,[t(p,{color:"green-6","text-color":"white",icon:"trending_up"})]),e("div",E,[o[4]||(o[4]=e("div",{class:"text-caption text-grey-7"},"Ingresos",-1)),e("div",R,g(d.money(s.totals.ingresos)),1)])]),_:1})]),_:1})]),e("div",F,[t(r,{flat:"",bordered:"",class:"shadow-1"},{default:l(()=>[t(i,{class:"row items-center q-col-gutter-sm"},{default:l(()=>[e("div",U,[t(p,{color:"red-6","text-color":"white",icon:"trending_down"})]),e("div",L,[o[5]||(o[5]=e("div",{class:"text-caption text-grey-7"},"Egresos",-1)),e("div",P,g(d.money(s.totals.egresos)),1)])]),_:1})]),_:1})]),e("div",z,[t(r,{flat:"",bordered:"",class:"shadow-1"},{default:l(()=>[t(i,{class:"row items-center q-col-gutter-sm"},{default:l(()=>[e("div",H,[t(p,{color:"blue-6","text-color":"white",icon:"account_balance_wallet"})]),e("div",W,[o[6]||(o[6]=e("div",{class:"text-caption text-grey-7"},"Neto",-1)),e("div",j,g(d.money(s.totals.neto)),1)])]),_:1})]),_:1})])]),e("div",G,[e("div",J,[t(r,{flat:"",bordered:"",class:"shadow-1"},{default:l(()=>[t(i,null,{default:l(()=>o[7]||(o[7]=[e("div",{class:"text-subtitle1 text-weight-bold"},"Diario",-1),e("div",{class:"text-caption text-grey-7"},"Ingresos / Egresos / Neto",-1)])),_:1}),t(_),t(i,null,{default:l(()=>[t(u,{type:"line",height:"320",options:s.lineOptions,series:s.lineSeries},null,8,["options","series"])]),_:1})]),_:1})]),e("div",K,[t(r,{flat:"",bordered:"",class:"shadow-1"},{default:l(()=>[t(i,null,{default:l(()=>o[8]||(o[8]=[e("div",{class:"text-subtitle1 text-weight-bold"},"MÃ©todos de pago",-1),e("div",{class:"text-caption text-grey-7"},"Solo ingresos",-1)])),_:1}),t(_),t(i,null,{default:l(()=>[t(u,{type:"donut",height:"320",options:s.donutOptions,series:s.donutSeries},null,8,["options","series"])]),_:1})]),_:1})]),e("div",T,[t(r,{flat:"",bordered:"",class:"shadow-1"},{default:l(()=>[t(i,null,{default:l(()=>o[9]||(o[9]=[e("div",{class:"text-subtitle1 text-weight-bold"},"Ingresos por usuario",-1),e("div",{class:"text-caption text-grey-7"},"Ranking del periodo",-1)])),_:1}),t(_),t(i,null,{default:l(()=>[t(u,{type:"bar",height:"340",options:s.barOptions,series:s.barSeries},null,8,["options","series"])]),_:1})]),_:1})])]),t(S,{showing:s.loading},{default:l(()=>[t(N,{size:"34px"})]),_:1},8,["showing"])]),_:1})}const rs=b(V,[["render",X],["__scopeId","data-v-9ec5a461"]]);export{rs as default};
