import{j as y,k as N,l as E,m as U,_ as B,c as m,o as r,w as i,a as l,Q as V,e as h,b as o,f as p,an as u,d as b,a2 as v,a3 as Q,a4 as _,Z as d,t as c,a5 as G,W as w,h as I,as as S}from"./index-Jso25Eoj.js";import{Q as q}from"./QPagination-BnmswFrR.js";import{Q as z,a as g}from"./QTh-DrGMisdy.js";import{Q as x,a as f,d as T}from"./format-RUThioNZ.js";import{Q as O,a as M}from"./QList-DHXvOrLz.js";import{Q as j}from"./QMarkupTable-UMVbcREu.js";import{Q as A}from"./QSpace-CebMmhD0.js";import{Q as F}from"./QSelect-CvxpBSHJ.js";import{Q as H}from"./QForm-DLXOYDdo.js";import{Q as L}from"./QPage-D2s4N9Sv.js";import{C as k}from"./ClosePopup-BTegNjP4.js";import"./selection-C0rq1wmY.js";import"./QBtnGroup-r18L-gnQ.js";const P=y({name:"QTr",props:{props:Object,noHover:Boolean},setup(n,{slots:t}){const C=N(()=>"q-tr"+(n.props===void 0||n.props.header===!0?"":" "+n.props.__trClass)+(n.noHover===!0?" q-tr--no-hover":""));return()=>E("tr",{style:n.props?.__trStyle,class:C.value},U(t.default))}}),W={name:"ClientesPage",data(){return{loading:!1,clients:[],client:{},clientDialog:!1,actionClient:"",filter:"",statuses:["Confiable","No Confiable","VIP"],columns:[{name:"actions",label:"Acciones",align:"center"},{name:"name",label:"Nombre",field:"name",align:"left"},{name:"ci",label:"CI",field:"ci",align:"left"},{name:"cellphone",label:"Celular",field:"cellphone",align:"left"},{name:"status",label:"Estado",field:"status",align:"left"}],pagination:{page:1,rowsPerPage:100,rowsNumber:0}}},mounted(){this.clientsGet()},methods:{rowColorClass(n){switch(n.status){case"Confiable":return"bg-green-1";case"No Confiable":return"bg-orange-1";case"VIP":return"bg-yellow-2 text-bold";default:return""}},clientsGet(){this.loading=!0,this.$axios.get("clients",{params:{page:this.pagination.page,per_page:this.pagination.rowsPerPage,search:this.filter}}).then(n=>{this.clients=n.data.data,this.pagination.rowsNumber=n.data.total}).catch(n=>{this.$alert.error(n.response?.data?.message||"Error al obtener clientes")}).finally(()=>{this.loading=!1})},clientNew(){this.client={name:"",ci:"",status:"Confiable",cellphone:"",address:"",observation:""},this.actionClient="Nuevo",this.clientDialog=!0},clientEdit(n){this.client={...n},this.actionClient="Editar",this.clientDialog=!0},clientPost(){this.loading=!0,this.$axios.post("clients",this.client).then(()=>{this.clientDialog=!1,this.clientsGet(),this.$alert.success("Cliente creado")}).catch(n=>{this.$alert.error(n.response?.data?.message||"Error al crear cliente")}).finally(()=>{this.loading=!1})},clientPut(){this.loading=!0,this.$axios.put("clients/"+this.client.id,this.client).then(()=>{this.clientDialog=!1,this.clientsGet(),this.$alert.success("Cliente actualizado")}).catch(n=>{this.$alert.error(n.response?.data?.message||"Error al actualizar cliente")}).finally(()=>{this.loading=!1})},clientDelete(n){this.$alert.dialog("¿Desea eliminar este cliente?").onOk(()=>{this.$axios.delete("clients/"+n).then(()=>{this.clientsGet(),this.$alert.success("Cliente eliminado")}).catch(t=>{this.$alert.error(t.response?.data?.message||"Error al eliminar cliente")})})}}},Z={class:"row"},J={class:"col-12 col-md-3"},K={class:"col-12 col-md-4"},R={class:"col-12 col-md-2 text-right"},X={class:"col-12 flex flex-center"},Y={class:"col-12"},$={class:"text-h6"},ee={class:"q-gutter-sm q-mt-md text-right"};function le(n,t,C,te,a,s){return r(),m(L,{class:"q-pa-xs"},{default:i(()=>[l(V,{flat:"",bordered:""},{default:i(()=>[l(h,null,{default:i(()=>[o("div",Z,[o("div",J,[l(p,{color:"positive",label:"Nuevo Cliente",onClick:s.clientNew,icon:"add","no-caps":"",loading:a.loading},null,8,["onClick","loading"])]),t[14]||(t[14]=o("div",{class:"col-12 col-md-3 text-right"},null,-1)),o("div",K,[l(u,{dense:"",outlined:"",debounce:"300",modelValue:a.filter,"onUpdate:modelValue":t[0]||(t[0]=e=>a.filter=e),placeholder:"Buscar",clearable:""},{append:i(()=>[l(b,{name:"search"})]),_:1},8,["modelValue"])]),o("div",R,[l(p,{color:"primary",label:"Actualizar",onClick:s.clientsGet,icon:"refresh","no-caps":"",loading:a.loading},null,8,["onClick","loading"])]),o("div",X,[l(q,{modelValue:a.pagination.page,"onUpdate:modelValue":[t[1]||(t[1]=e=>a.pagination.page=e),s.clientsGet],max:Math.ceil(a.pagination.rowsNumber/a.pagination.rowsPerPage),"rows-per-page-options":[10,25,50,100],"rows-per-page":a.pagination.rowsPerPage},null,8,["modelValue","max","rows-per-page","onUpdate:modelValue"])]),o("div",Y,[l(j,{dense:"",flat:"",bordered:""},{default:i(()=>[l(P,{class:"bg-primary text-white"},{default:i(()=>[(r(!0),v(Q,null,_(a.columns,e=>(r(),m(z,{key:e.name,align:e.align},{default:i(()=>[d(c(e.label),1)]),_:2},1032,["align"]))),128))]),_:1}),(r(!0),v(Q,null,_(a.clients,e=>(r(),m(P,{key:e.id,class:G(s.rowColorClass(e))},{default:i(()=>[l(g,{align:"center"},{default:i(()=>[l(O,{color:"primary",label:"Opciones",dense:"","no-caps":"",size:"10px",loading:a.loading},{default:i(()=>[l(M,null,{default:i(()=>[w((r(),m(x,{clickable:"",onClick:D=>s.clientEdit(e)},{default:i(()=>[l(f,{avatar:""},{default:i(()=>[l(b,{name:"edit"})]),_:1}),l(f,null,{default:i(()=>t[12]||(t[12]=[d("Editar")])),_:1})]),_:2},1032,["onClick"])),[[k]]),w((r(),m(x,{clickable:"",onClick:D=>s.clientDelete(e.id)},{default:i(()=>[l(f,{avatar:""},{default:i(()=>[l(b,{name:"delete"})]),_:1}),l(f,null,{default:i(()=>t[13]||(t[13]=[d("Eliminar")])),_:1})]),_:2},1032,["onClick"])),[[k]])]),_:2},1024)]),_:2},1032,["loading"])]),_:2},1024),l(g,null,{default:i(()=>[d(c(e.name),1)]),_:2},1024),l(g,null,{default:i(()=>[d(c(e.ci),1)]),_:2},1024),l(g,null,{default:i(()=>[d(c(e.cellphone),1)]),_:2},1024),l(g,null,{default:i(()=>[l(T,{color:e.status==="Confiable"?"green":e.status==="No Confiable"?"red":"orange","text-color":"white",dense:"",size:"10px"},{default:i(()=>[d(c(e.status),1)]),_:2},1032,["color"])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})])])]),_:1})]),_:1}),l(I,{modelValue:a.clientDialog,"onUpdate:modelValue":t[11]||(t[11]=e=>a.clientDialog=e),persistent:""},{default:i(()=>[l(V,{style:{width:"500px"}},{default:i(()=>[l(h,{class:"row items-center"},{default:i(()=>[o("div",$,c(a.actionClient)+" Cliente",1),l(A),l(p,{icon:"close",flat:"",round:"",dense:"",onClick:t[2]||(t[2]=e=>a.clientDialog=!1)})]),_:1}),l(h,null,{default:i(()=>[l(H,{onSubmit:t[10]||(t[10]=S(e=>a.client.id?s.clientPut():s.clientPost(),["prevent"]))},{default:i(()=>[l(u,{modelValue:a.client.name,"onUpdate:modelValue":t[3]||(t[3]=e=>a.client.name=e),label:"Nombre",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"]),l(u,{modelValue:a.client.ci,"onUpdate:modelValue":t[4]||(t[4]=e=>a.client.ci=e),label:"CI",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"]),l(F,{modelValue:a.client.status,"onUpdate:modelValue":t[5]||(t[5]=e=>a.client.status=e),label:"Estado",options:a.statuses,outlined:"",dense:""},null,8,["modelValue","options"]),l(u,{modelValue:a.client.cellphone,"onUpdate:modelValue":t[6]||(t[6]=e=>a.client.cellphone=e),label:"Celular",outlined:"",dense:""},null,8,["modelValue"]),l(u,{modelValue:a.client.address,"onUpdate:modelValue":t[7]||(t[7]=e=>a.client.address=e),label:"Dirección",outlined:"",dense:""},null,8,["modelValue"]),l(u,{modelValue:a.client.observation,"onUpdate:modelValue":t[8]||(t[8]=e=>a.client.observation=e),label:"Observación",outlined:"",dense:"",type:"textarea"},null,8,["modelValue"]),o("div",ee,[l(p,{flat:"",label:"Cancelar",color:"negative",onClick:t[9]||(t[9]=e=>a.clientDialog=!1),loading:a.loading},null,8,["loading"]),l(p,{label:"Guardar",type:"submit",color:"primary",loading:a.loading},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const he=B(W,[["render",le]]);export{he as default};
